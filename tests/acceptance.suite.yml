# Acceptance suite configuration
#
# Run Acceptance Tests with ChromeDriver.

actor: AcceptanceTester
bootstrap: _bootstrap.php
modules:
    enabled:
        - lucatume\WPBrowser\Module\WPDb
        - lucatume\WPBrowser\Module\WPFilesystem
        - lucatume\WPBrowser\Module\WPLoader
        - lucatume\WPBrowser\Module\WPWebDriver
        - Tests\Support\Helper\Acceptance
        - Asserts
    config:
        Tests\Support\Helper\WPDb:
          plugins: 
          theme-stylesheet: 'bwb-chap-child'
          theme-template: 'chap'
        lucatume\WPBrowser\Module\WPWebDriver:
          url: '%WORDPRESS_URL%'
          adminUsername: '%WORDPRESS_ADMIN_USER%'
          adminPassword: '%WORDPRESS_ADMIN_PASSWORD%'
          adminPath: '/wp-admin'
          browser: chrome
          host: '%WEBDRIVER_HOST%'
          port: '%WEBDRIVER_PORT%'
          path: '/'
          window-size: 1920x1080
          capabilities:
            goog:chromeOptions: 
              args: ["--ignore-certificate-errors", "--headless", "--window-size=1920x1080", "--no-sandbox", "--disable-gpu", "allow-insecure-localhost"]
              prefs: 
                download.default_directory: '%PWD%/tests/_output/'
                download.prompt_for_download: false
                download.directory_upgrade: true
                safebrowsing.enabled: false
                safebrowsing.disable_download_protection: true
                Page.setDownloadBehavior: {behavior: 'allow', downloadPath: 'tests/_output/'}
        lucatume\WPBrowser\Module\WPDb:
          dbUrl: '%WORDPRESS_DB_SEED_URL%'
          dump:
            - 'wp-content/mysql.sql'
          populate: true
          cleanup: true
          reconnect: false
          url: '%WORDPRESS_URL%'
          urlReplacement: false
          tablePrefix: '%SEED_TABLE_PREFIX%'
          createIfNotExists: true
        lucatume\WPBrowser\Module\WPFilesystem:
          wpRootFolder: '%WORDPRESS_ROOT_DIR%'
        lucatume\WPBrowser\Module\WPLoader:
          loadOnly: true
          wpRootFolder: "%WORDPRESS_ROOT_DIR%" 
          dbUrl: '%WORDPRESS_DB_SEED_URL%'
          domain: '%WORDPRESS_DOMAIN%'
          debug: true
